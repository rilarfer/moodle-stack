<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="http://rilarfer.stack-moodle.com/Authoring/JSXGraph/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>JSXGraph - STACK</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "JSXGraph";
        var mkdocs_page_input_path = "Authoring\\JSXGraph.md";
        var mkdocs_page_url = "/Authoring/JSXGraph/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> STACK
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Buscar documentos" aria-label="Buscar documentos" title="Escriba el término de búsqueda aquí" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Menu de navegación">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Inicio</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../About/">About</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/">Guía Autoría inicio rápido</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/Authoring_quick_start_1/">1 Una pregunta básica</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/Authoring_quick_start_2/">2 Variables de la pregunta</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/Authoring_quick_start_3/">3 Mejorando la retroalimentación</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/Authoring_quick_start_4/">4 Aleatorización</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/Authoring_quick_start_5/">5 Test de Preguntas</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/Authoring_quick_start_6/">6 Preguntas matemáticas de varias partes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/Authoring_quick_start_7/">7 Desactivar la simplificación</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/Authoring_quick_start_8/">8 Importación y cuestionarios</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../">Autoría</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../CAS/">CAS</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../Installation/">Instalación</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../Developer/">Desarrolladores</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../Moodle/">Moodle</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../Reference/">Referencias</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../Students/">Estudiantes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../Topics/">Temas</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Menú de navegación en móvil">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">STACK</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Documentos"></a></li>
      <li class="breadcrumb-item active">JSXGraph</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="jsxgraph">JSXGraph</h1>
<p>This page documents use of JSXGraph to display visuals. This is a somewhat advanced topic. For basic plots and visuals you may prefer to <a href="../../CAS/Plots/">use Maxima to plot graphs</a>. </p>
<p>STACK supports inclusion of dynamic graphs using JSXGraph: <a href="http://jsxgraph.uni-bayreuth.de/wiki/">http://jsxgraph.uni-bayreuth.de/wiki/</a>.</p>
<p>Note, we strongly recommend you do not use an HTML-aware editor when using JSXGraph questions.  Instead turn off the editor within Moodle and edit the raw HTML.</p>
<pre><code>Site administration &gt; Plugins &gt; Text editors &gt; Manage editors
</code></pre>
<p>Individual users can also set their editor preferences:</p>
<pre><code>User Dashboard &gt; Preferences &gt; Editor preferences &gt; Manage editors
</code></pre>
<h2 id="include-basic-plots">Include basic plots</h2>
<p>This example is based on the documentation for <a href="http://jsxgraph.uni-bayreuth.de/wiki/index.php/Curve">curve</a> and the <a href="http://jsxgraph.uni-bayreuth.de/wiki/index.php/Even_simpler_function_plotter">even simpler function plotter</a> example.</p>
<p>To include a basic dynamically-generated sketch into a STACK question, first define the expression of the graph to be plotted in the question variables.  For example</p>
<pre><code>a:rand(6)-3;
fx:sin(x)+a;
</code></pre>
<p>Then include the following question text, which includes a simple <code>[[jsxgraph]]</code> <a href="../Question_blocks/Dynamic_blocks/">block</a>.  In particular note the lack of <code>&lt;script&gt;</code> tags which you might expect to include.</p>
<pre><code>&lt;p&gt;Type in an algebraic expression which has the graph shown below.&lt;/p&gt;
[[jsxgraph]]
  // boundingbox:[left, top, right, bottom]
  var board = JXG.JSXGraph.initBoard(divid, {boundingbox: [-10, 5, 10, -5], axis: true, showCopyright: false});
  var f = board.jc.snippet('{#fx#}', true, 'x', true);
  board.create('functiongraph', [f,-10,10]);
[[/jsxgraph]]
&lt;p&gt;\(f(x)=\) [[input:ans1]] [[validation:ans1]]&lt;/p&gt;
</code></pre>
<p>Note the code <code>board.jc.snippet('{#fx#}', true, 'x', true);</code> which turns a reasonable expression for a function into the JavaScript function.  You cannot just plot the <code>functiongraph</code> on its own.</p>
<p>To make a working question, you will then need to add in <code>fx</code> as the model answer to input <code>ans1</code>, a question note (e.g. <code>\({@fx@}\)</code>) and an appropriate potential response tree.</p>
<h2 id="block-options">Block options</h2>
<p>You can control the size of the JSXGraph board with the <code>width</code> and <code>height</code> options.  E.g. </p>
<pre><code>[[jsxgraph width="200px" height="200px"]]
</code></pre>
<p>The option <code>aspect-ratio</code> combinet with the ability to use relative dimensions allows for graphs to resize and maintain its shape if the viewport changes. When using <code>aspect-ratio</code> it is necessary to define one and only one of the above lengths.</p>
<pre><code>[[jsxgraph width="80%" aspect-ratio="3/2"]]
</code></pre>
<p>If no size is defined the default is to have <code>width="500px" height="400px"</code> and these are also the dimensions used if values are missing and no <code>aspect-ratio</code> has been defined.</p>
<h2 id="automatic-identifier-for-the-div-element">Automatic identifier for the div-element</h2>
<p>As initialisation of the JSXGraph board requires you to give it a reference to the div-element that will contain the graph you will need to know what that id is. With the JSXGraph-block that identifier is present in a variable named <code>divid</code>. Since, 4.3.3 we also provide that same identifier in a variable named <code>BOARDID</code> to match the behaviour of the JSXGraph Moodle filter. We generate that identifier automatically to allow one to have multiple plots even multiple copies of the same question on the same page without anyone having to worry about accidental identifier clashing.</p>
<h2 id="interactive-elements">Interactive elements</h2>
<p>In this example define the question variables as</p>
<pre><code>fx:int(expand((x-1)*(x+1)*(x-2)),x);
</code></pre>
<p>This question contains an interactive sliding element.</p>
<pre><code>&lt;p&gt;A graph, together with the tangent line and its slope, are shown below.  Find an algebraic expression for the graph shown below.&lt;/p&gt;
[[jsxgraph]]
  // boundingbox:[left, top, right, bottom]
  var board = JXG.JSXGraph.initBoard(divid, {boundingbox: [-5, 10, 5, -10], axis: true, showCopyright: false});
  var f = board.jc.snippet('{#fx#}', true, 'x', true);
  var curve = board.create('functiongraph', [f,-10,10], {strokeWidth:2});
  var dcurve = board.create('functiongraph', [JXG.Math.Numerics.D(f),-10,10], {strokeColor:'#ff0000', strokeWidth:1, dash:2});
  var p = board.create('glider',[1,0,curve], {name:'Drag me'});
  board.create('tangent',[p], {name:'Drag me'});
  var q = board.create('point', [function(){return p.X();}, function(){return JXG.Math.Numerics.D(f)(p.X());} ], {withLabel:false});
  board.unsuspendUpdate();
[[/jsxgraph]]
&lt;p&gt;\(f(x)=\) [[input:ans1]] [[validation:ans1]]&lt;/p&gt;
</code></pre>
<p>In this example the student can interact with a dynamic diagram to help them understand what is going on.</p>
<h2 id="an-example-with-a-slider">An example with a slider</h2>
<p>In this example we provide a simple slider.  Notice in this example we use the JavaScript notation <code>a**x</code> for <script type="math/tex">a^x</script> and not Maxima's <code>a^x</code>.</p>
<pre><code>[[jsxgraph]]
  // boundingbox:[left, top, right, bottom]
  var board = JXG.JSXGraph.initBoard(divid, {boundingbox: [-5, 10, 5, -10], axis: true, showCopyright: false});
  var a = board.create('slider',[[-3,6],[2,6],[0,2,6]],{name:'a'}); 
  var curve = board.create('functiongraph', [function(x) {return a.Value()**x}], {strokeWidth:2});
  board.unsuspendUpdate();
[[/jsxgraph]]
</code></pre>
<h2 id="general-considerations-when-building-interactive-graphs">General considerations when building interactive graphs</h2>
<p>In general you should pay attention on how your graph reacts to the student returning to the page/question later. For example, will your graph 
reset to display the original situation or will it at least move all movable things to the positions the student last left them? If 
the student can do things that are not actually considered as part of the answer, e.g. zoom out or pan the view, do you also remember 
those actions? If your graph is not used for inputting answers then this is not a major issue but if it is then you will need to solve 
this issue. Basically, storing the state of the interactive graph is a key thing that the author of that graph needs to deal with.</p>
<p>The basic structure of such graph logic is as follows:</p>
<ol>
<li>Load existing state or if not found initialise with defaults.</li>
<li>Draw the graph based on that state.</li>
<li>Attach listeners to everything that can be changed in the graph and store those changes into the state in those listeners.</li>
</ol>
<p>The simplest solution for storing state is to add a <code>string</code> type input field to the question. </p>
<ol>
<li>Create and hide an input with CSS, e.g. <code>&lt;p style="display:none"&gt;[[input:stateStore]] [[validation:stateStore]]&lt;/p&gt;</code> (but probably not while you develop the question!)</li>
<li>Make the input a "string" type.</li>
<li>Turn off the validation and verification of the field. </li>
<li>Use the extra option <code>hideanswer</code> to make sure the teacher's answer is not shown to students.</li>
<li>That input field should not be connected to any PRTs.</li>
<li>You can use the syntax hint feature to pass in a default value but only if that is not parametric (currently the syntax hint is not CASText: see the todo list).</li>
</ol>
<p>You can use that input field to store the state of the graph as a string, for example as a JSON-encoded structure. For example, assuming the name of the String input is named <code>stateStore</code>, we can store the position of a point as follows:</p>
<pre><code>[[jsxgraph input-ref-stateStore="stateRef"]]
  // Note that the input-ref-X attribute above will store the element identifier of the input X in 
  // a variable named in the attribute, you can have multiple references to multiple inputs.

  // Create a normal board.
  var board = JXG.JSXGraph.initBoard(divid, {axis: true, showCopyright: false});

  // State represented as a JS-object, first define default then try loading the stored values.
  var state = {'x':4, 'y':3};
  var stateInput = document.getElementById(stateRef);
  if (stateInput.value &amp;&amp; stateInput.value != '') {
    state = JSON.parse(stateInput.value);
  }

  // Then make the graph represent the state
  var p = board.create('point',[state['x'],state['y']]);

  // And finally the most important thing, update the stored state when things change.
  p.on('drag', function() {
    var newState = {'x':p.X(), 'y':p.Y()};
    // Encode the state as JSON for storage and store it
    stateInput.value = JSON.stringify(newState);
    // Since the STACK-JS system one needs to also remember to tell others
    // about the changed value. Do this by dispatching an event.
    stateInput.dispatchEvent(new Event('change'));
  });

  // As a side note, you typically do not want the state storing input to be directly visible to the user
  // although it may be handy during development to see what happens in it. You might hide it like this:
  stateInput.style.display = 'none';
[[/jsxgraph]]
</code></pre>
<p>Note, in the above example in <code>[[jsxgraph input-ref-stateStore="stateRef"]]</code> the <code>stateStore</code> part of this tag directly relates to, and must match, the name of the input.</p>
<p>In that trivial example you only have one point that you can drag around but the position of that point will be stored and it will be where 
you left it when you return to the page. However, the position has been stored in a String encoded in JSON format and cannot directly be 
used in STACK-side logic. The JSON format is however very handy if you create objects to store dynamically and want to represent things 
of more complex nature, but in this example we could have just as well have had two separate Numeric inputs storing just the raw 'x' 
and 'y' coordinates separately as raw numbers and in that case we could have used them directly in STACK's grading logic.</p>
<p>If needed, JSON is not impossible to parse in STACK, but it is not easy (as in JavaScript) because Maxima has no map 
data-structures and is not object oriented. In any case, the JSON string generated in the previous example would look like this:</p>
<pre><code>stateStore:"{\"x\":4,\"y\":3}";
</code></pre>
<p>To parse and manipulate it you can use STACK's custom JSON parsing functions:</p>
<pre><code>tmp:stackjson_parse(stateStore); /* This returns a STACK-map: ["stack_map", ["x", 4], ["y", 3]] */
x:stackmap_get(tmp,"x");         /* 4 */
y:stackmap_get(tmp,"y");         /* 3 */
tmp:stackmap_set(tmp,"z",x*y);   /* ["stack_map", ["x", 4], ["y", 3], ["z", 12]] */
json:stackjson_stringify(tmp);   /* "{\"x\":4,\"y\":3,\"z\":12}" */
</code></pre>
<h2 id="convenience-tools-for-building-graphs">Convenience tools for building graphs</h2>
<p>The previous section covered the general case of storing the state of the graph and acting on it. Typically, you only need to handle a few points and maybe some sliders and for this task we provide ready-made functions that bind those primitive objects to STACK input fields. As these binding functions only deal with singular sliders and points they will also use simpler forms of passing around the values.</p>
<p>The example in the previous section about moving the point around and storing the points position as an JSON object can be redone with the convenience functions in much simpler form. The only major differences being that the value is stored as a raw list of float values, and the input field should not be of the String type instead we can store it as Algebraic input and directly access the values, just make sure you allow float values in that input.</p>
<pre><code>[[jsxgraph input-ref-stateStore="stateRef"]]
  // Create a board like normal.
  var board = JXG.JSXGraph.initBoard(divid, {axis: true, showCopyright: false});

  // Create a point, its initial position will be the default position if no state is present.
  var p = board.create('point', [4, 3]);

  // Bind it to the input and state stored in it.
  stack_jxg.bind_point(stateRef, p);

  // As a side note, you typically do not want the state storing input to be directly visible to the user
  // although it may be handy during development to see what happens in it. You might hide it like this:
  var stateInput = document.getElementById(stateRef);
  stateInput.style.display = 'none';
[[/jsxgraph]]
</code></pre>
<p>For sliders you use the function <code>stack_jxg.bind_slider(inputRef, slider)</code> and it stores the sliders value as a raw float. Sliders will however require that you call <code>board.update()</code> after binding to them, otherwise the graph may not display the stored state after reload.</p>
<p>You should check the sample questions about JSXGraph binding for examples of these functions in action.</p>
<p>Starting from version 4.3 there are three functions for dealing with pairs of points. Basically, if you want to represent vectors, lines or circles or anything that can be defined with just two points. <code>stack_jxg.bind_point_dual(inputRef, point1, point2)</code> will store the positions of the points into a single input as a list of lists, <code>stack_jxg.bind_point_relative(inputRef, point1, point2)</code> will also generate a list but in it the second point is represented relative to the first, and finally <code>stack_jxg.bind_point_direction(inputRef, point1, point2)</code> will provide the first point as coordinates and the second point as an angle and distance from the first.</p>
<p>Starting from 4.4 there is only one new bind function <code>stack_jxg.bind_list_of(inputRef, list)</code> which takes a list of points and/or sliders and stores it into a single input. It only works if he size or order of the list does not change during page loads, however the list can change its shape for variants of the question. The primary use target for this are the vertices of polygons, but one can probably come up with something else as well, it does work as a quick and dirty way of storing the whole graph state if the graph can be defined just by points and sliders.</p>
<p>There are also two new functions realted to dealing with groups of objects and matching inputs. For situations where the answer consists of multiple elements and it is possible that not all get moved one can use <code>stack_jxg.define_group(list)</code> which takes a list of points and/or sliders and makes it so that touching any one of them will trigger them all to be considered as touched and thus generates inputs. There is also <code>stack_jxg.starts_moved(object)</code> which takes a point or a slider and marks it as touched from the start, this may be of use if the graph is an optional part and the actual grading depends of other parts or if one wants to use PRT feedback as a way for describing the status of the graph and needs the objects to be transferred onto the CAS side without interaction from the student.</p>
<h2 id="convenience-tools-for-generating-lists-of-values">Convenience tools for generating lists of values.</h2>
<p>If you want to output a list of values without Maxima's normal bracket symbols you can use</p>
<pre><code>stack_disp_comma_separate([a,b,sin(pi)]);
</code></pre>
<p>This function turns a list into a string representation of its arguments, without braces.
Internally, it applies <code>string</code> to the list of values (not TeX!).  However, you might still get things like <code>%pi</code> in the output.</p>
<p>You can use this with mathematical input: <code>{@stack_disp_comma_separate([a,b,sin(pi)])@}</code> and you will get the result <code>a, b, sin(%pi/7)</code> (without the string quotes) because when a Maxima variable is a string we strip off the outside quotes and don't typeset this in maths mode.</p>
<h2 id="discrete-mathematics-and-graph-theory">Discrete mathematics and graph theory.</h2>
<p>A graph can be displayed with JSXGraph, see <a href="../../Topics/Discrete_mathematics/">discrete mathematics</a> for examples.</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright &copy; 2023 Ricardo Largaespada</p>
  </div>

  Construído con <a href="https://www.mkdocs.org/">MkDocs</a> usando <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provisto por <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versiones">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../../javascripts/removeCredits.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
