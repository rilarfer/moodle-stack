
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="http://rilarfer.stack-moodle.com/Topics/Vector_Calculus/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>Vector Calculus in STACK - STACK</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#vector-calculus-in-stack" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="STACK" class="md-header__button md-logo" aria-label="STACK" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            STACK
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Vector Calculus in STACK
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="STACK" class="md-nav__button md-logo" aria-label="STACK" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    STACK
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inicio
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../About/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acerca de STACK
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../AbInitio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guía Autoría inicio rápido
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../AbInitio/Authoring_quick_start_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1 Una pregunta básica
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../AbInitio/Authoring_quick_start_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2 Variables de la pregunta
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../AbInitio/Authoring_quick_start_3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3 Mejorando la retroalimentación
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../AbInitio/Authoring_quick_start_4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4 Aleatorización
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../AbInitio/Authoring_quick_start_5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5 Test de Preguntas
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../AbInitio/Authoring_quick_start_6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6 Preguntas matemáticas de varias partes
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../AbInitio/Authoring_quick_start_7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7 Desactivar la simplificación
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../AbInitio/Authoring_quick_start_8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8 Importación y cuestionarios
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../Authoring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autoría
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../CAS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CAS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../Installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Instalación
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../Developer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Desarrolladores
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../Moodle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Moodle
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../Reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Referencias
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../Students/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Estudiantes
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Temas
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="vector-calculus-in-stack">Vector Calculus in STACK</h1>
<p>Setting vector calculus problems using STACK does not require too much more thinking than setting regular calculus or linear algebra problems. There are a few extra additions, but a passing familiarity with Maxima's notation for derivatives, integrals and vectors will usually suffice.</p>
<h1 id="calculus-with-more-than-one-variable">Calculus with more than one variable</h1>
<p>To find derivatives of functions of more than one variable you can use the normal <code>diff(f,x)</code> function, which returns the partial derivative of <script type="math/tex">f</script> with respect to <script type="math/tex">x</script>. To find the gradient vector, you might choose to put all the partial derivatives in a list or matrix using something like</p>
<pre><code>grad(f,vars):= block(
  grad_vec: map(lambda([ex], 'diff(f,vars[ex])), ev(makelist(ii,ii,1,length(vars)), simp)),
  return(transpose(matrix(grad_vec)))
);
</code></pre>
<p>Then <code>grad(f,[x,y,z])</code> would return
<script type="math/tex; mode=display">
 \left[\begin{array}{c} \frac{\mathrm{d} f}{\mathrm{d} x} \\ \frac{\mathrm{d} f}{\mathrm{d} y} \\ \frac{\mathrm{d} f}{\mathrm{d} z} \end{array}\right]
</script>
Setting Maxima's <code>derivabbrev:true</code> changes the display of derivatives to subscripts.  Now <code>grad(f,[x,y,z])</code> would return
<script type="math/tex; mode=display">
\left[\begin{array}{c} f_{x} \\ f_{y} \\ f_{z} \end{array}\right]
</script>
</p>
<p>If you would like to work with differentials, using <code>diff(f)</code> without specifying a variable will return <code>del(f)</code>. For example, </p>
<pre><code>(%i1) f: x*y*z;
(%o1) x y z;
(%i2) diff(f);
(%o2) x y del(z) + x z del(y) + y z del(x)
</code></pre>
<p>The Maxima differentials will display as <script type="math/tex">d(x)</script>.  If you prefer notation such as <script type="math/tex">\mathrm{d}x</script> you might like to redfine the tex function associated with <code>del</code> e.g.</p>
<pre><code>texput(del,lambda([ex],sconcat("\\mathrm{d}",tex1(first(ex)))));
</code></pre>
<p>If you need to assert that one or more variables are constant, you can use <code>declare([a,b,c],constant)</code> means that, using the previous example, <code>diff(f*c)</code> would return <code>c x y del(z) + c x z del(y) + c y z del(x)</code> rather than <code>c x y del(z) + c x z del(y) + c y z del(x) + x y z del(c)</code>.</p>
<p>If you want to assert that one variable depends on the other, you can use <code>depends([f,g],[x,y])</code> to mean that <script type="math/tex">f</script> and <script type="math/tex">g</script> both depend on <script type="math/tex">x</script> and <script type="math/tex">y</script>. If you just want to note that <script type="math/tex">y</script> depends on <script type="math/tex">x</script>, then <code>depends(y,x)</code> is sufficient. This is useful when asking students to perform implicit partial differentiation and solve for the given derivative. Here is an example that wants students to find a partial derivative of one variable with respect to another, holding another variable constant: </p>
<pre><code>declare([a,b,c,d],constant);
eqn1: x*y = a*t^b*z;
eqn2: c*z*y^d*t = sin(x);
[eqn1, eqn2]: random_permutation([eqn1, eqn2]);

[dep1,dep2,indep,const]: random_permutation([x, y, z, t]);
depends([dep1,dep2],indep);

eqn1d: diff(eqn1,indep);
eqn2d: diff(eqn2,indep);

ta: rhs(flatten(solve([eqn1d,eqn2d],['diff(dep1,indep),'diff(dep2,indep)]))[1]);
</code></pre>
<p>This example generates two equations in <script type="math/tex">x</script>, <script type="math/tex">y</script>, <script type="math/tex">z</script> and <script type="math/tex">t</script>, assigns each variable a role as either a dependent variable, independent variable, or a variable being held constant (also independent, but behaving differently in this context), differentiates both equations implicitly with respect to the independent variable, and then solves the equations simultaneously for the desired derivative. The original question had values assigned to <script type="math/tex">a</script>, <script type="math/tex">b</script>, <script type="math/tex">c</script> and <script type="math/tex">d</script>, but it is interesting to declare them constant here. </p>
<p>Note that these questions can be a bit volatile, as Maxima simply cannot establish equality when various substitutions are made. It may be prudent to make rearrangement difficult, and/or tell students to not substitute values in their answer. </p>
<h1 id="using-vectors">Using vectors</h1>
<p>Maxima does not distinguish between vectors and matrices, with both being defined using the <code>matrix</code> command. You can put whatever you like in a matrix, so like the example above with a gradient vector, you can easily define a vector function as a matrix with expressions as elements. Some key points: </p>
<ol>
<li>Lists are treated very similarly to row vectors (which means that things like the dot product operator work on them). It also means that it is sufficient to use <code>transpose([a,b,c])</code> to get a column vector.</li>
<li><code>*</code> is used for element-wise multiplication of lists and matrices, whereas <code>.</code> is used as both a dot product and matrix product. This leads to slightly confusing behaviour for vectors, where <code>[x,y] . [z,t]</code>, <code>[x,y] . transpose([z,t])</code> and <code>transpose([x,y]) . transpose([z,t])</code> will all return <code>x*z + y*t</code>, but <code>transpose([x,y]) . [z,t]</code> will return the outer product matrix <code>matrix([x*z, t*x], [y*z, t*y])</code>.</li>
<li>Matrices are indexed as <code>A[i,j]</code>, which means that when dealing with vectors you must be careful to index both the row and the column. For example, <code>matrix([1],[2],[3])[1]</code> will return the list <code>[1]</code> rather than the value <code>1</code>, and <code>matrix([1,2,3])[1]</code> will return the whole row <code>[1,2,3]</code>. One way around this is to use the <code>list_matrix_entries</code> function to return the list of all matrix entries, which is often easier to work with when considering vectors. Note that this function returns an error when given a list. </li>
<li>The function <code>crossproduct(a,b)</code> is defined in STACK (not core Maxima), but must take two <script type="math/tex">3</script> by <script type="math/tex">1</script> column vectors as the input, not lists or row vectors. </li>
<li>The function <code>jacobian([f1,f2],[x,y])</code> is defined, and takes two lists as arguments. The first is the vector function, and the second is the list of variables. </li>
</ol>
<p>Some useful functions that are <em>not</em> defined in core Maxima are defined in STACK's contributed <code>vectorcalculus.mac</code> file in the contrib directory.</p>
<ol>
<li>divergence <code>div(u, vars)</code>. Accepts <script type="math/tex">u</script> as either a matrix or a list.</li>
<li>curl <code>curl(u, vars)</code>.  Accepts <script type="math/tex">u</script> as either a matrix or a list.</li>
</ol>
<p>These functions can be <a href="../../Authoring/Inclusions/">included</a> with <code>stack_include</code>.</p>
<h1 id="lagrange-multipliers">Lagrange Multipliers</h1>
<p>Finding critical points using the method of Lagrange multipliers is as simple as finding the stationary points to the system of equations given by <script type="math/tex">f - \lambda c</script> where <script type="math/tex">f</script> is the multivariable function you are investigating and <script type="math/tex">c</script> is a constraint curve. There are a few new considerations that come along with questions like this, such as what input type to use and how to account for a variable number of solutions.  </p>
<p>Here is some example code that shows how you might procedurally generate solutions to a problem like this, where <code>func</code> is our function <script type="math/tex">f</script> and <code>cons</code> is our constraint curve <script type="math/tex">c</script> given as a single algebraic expression to be set to zero. </p>
<pre><code>equations: [diff(func, x) = L*diff(cons, x), diff(func, y) = L*diff(cons, y), cons = 0];
solns: map(lambda([ex],map(rhs,firstn(radcan(ex),2))),solve(equations, [x, y, L]));
ta: sublist(solns,lambda([ex],real_numberp(first(ex)) and real_numberp(second(ex))));
</code></pre>
<p>This code will generate all correct solutions, trim out the value of <script type="math/tex">\lambda</script> which typically does not concern us, removes any complex solutions, and returns the final answer as a list of ordered pairs. This is useful because it allows us to use the TextArea input type. To enter their answers, students can give as many or as ordered pairs as they like.</p>
<p>To mark this question, we could use some code like the following:</p>
<pre><code>ans1_set: setify(map(simplify, ans1));
ta_set: setify(map(simplify, ta));

num_correct: length(intersection(ans1_set, ta_set));
prop_correct: num_correct/length(ta);
</code></pre>
<p>Now we can compare the two sets directly in the PRT using AlgEquiv or Sets. If this test fails, we might like to award <code>prop_correct</code> marks as the score (so that if a student found 3 out of 4 critical points they would be awarded 0.75 marks). We might also find it prudent to award a flat penalty for any superfluous answers in this case too, or perhaps only if the student gives more answers than expected (to avoid double-penalising typos), though this is now a discussion of grading. </p>
<h1 id="vector-plots">Vector Plots</h1>
<p>Newer versions of JSXGraph provide support for vector plots natively, but STACK currently does not use this version of JSXGraph. However, it is not too difficult to create a bespoke vector plot function that can be adapted to a variety of circumstances.</p>
<p>There are several considerations when creating a vector plot:</p>
<p>1) How densely packed should the vectors be? 
2) How long should the vectors be, and how much variation in length should there be? 
3) What aesthetic choices are important to aid readability? 
4) How should function information be passed from Maxima to JSXGraph?</p>
<p>There is no single answer to these, and your answer will likely differ per question. Below is one approach to creating a vector plot question. Note that it assumes you are working with a plaintext editor and so <code>&lt;</code>, <code>&gt;</code>, and <code>&amp;&amp;</code> are all viable options. If you work in a different editor (such as a the Moodle default) you may like to define your own functions to prevent conversion to <code>&amp;lt;</code>, <code>&amp;gt;</code> or <code>&amp;amp;</code> upon saving. </p>
<p>Let us first assume a general vector function, called <code>F</code>. In the question variables, we could define <code>fx</code> and <code>fy</code> and then define <code>F: [fx,fy]</code>. If we were wanting to instead plot a gradient, we could define a function <code>f</code> and then define its gradient as <code>F: [diff(f,x),diff(f,y)]</code>. We will also need a version of <code>F</code> that uses valid JavaScript syntax. You might like to convert manually using something like <code>fx_jsx: ssubst("**","^",string(fx))</code>, though this relies on you knowing the form of the function and can cause problems with the unary minus. A better option could be to use <a href="https://jsxgraph.org/docs/symbols/JXG.JessieCode.html">JXG.JessieCode</a>. Lastly, we want a JavaScript function to output the direction at a given point. Something like the the following suffices.</p>
<pre><code>var F = function(x,y) { return [{@fx_jsx@},{@fy_jsx@}] };
</code></pre>
<p>Next, we want to know where we are plotting. Keeping everything in terms of the plotting axes and number of vectors will prove convenient. If we choose the number of vectors in the x-direction to be <code>num_x</code> and similarly for y to be <code>num_y</code>, we can set up the following: </p>
<pre><code>var xi = -2, yf = 2, xf = 2, yi = -2
var axes = [xi, yf, xf, yi]
var num_x = 20, num_y = 20
var dx = 1/num_x*(xf - xi)
var dy = 1/num_y*(yf - yi)
</code></pre>
<p>Our goal will be to plot vectors at every grid point defined by these steps in x and y called <code>dx</code> and <code>dy</code>.</p>
<p>Before we iterate through this, we need to define the function that will actually plot the vectors.</p>
<pre><code>var createVector = function(px, py) {
    var vec = F(px,py) /* Compute the value of the function here */
    var vecScaler = 1/Math.sqrt(vec[0]**2 + vec[1]**2)
    var plotVec = [dx*vec[0]*vecScaler, dy*vec[1]*vecScaler]
    var tip = [px + plotVec[0], py + plotVec[1]]
    board.create('arrow',[[px,py],tip],{
        color: "#1f77b4", opacity: 0.66, lastArrow: {type: 2, size: 4},
        fixed: true, highlight: false
    });
    board.create('point',[px,py],{
        color: "#1f77b4", size: 0.1, strokeOpacity: 0.66, fillOpacity: 0.75,
        highlight: false, fixed: true, withLabel: false
    });
}
</code></pre>
<p>A couple of things to note: Firstly, the variable <code>vecScaler</code> is always equal to the reciprocal of the length of the vector, which means that in this example it will always plot a "unit" vector (where a unit here is the grid size). This can (and perhaps should) be changed unless you wish to use colour to denote different vector length (which is poor accessibility practice on its own). Secondly, these vectors are eminating from the grid point, which is plotted itself with a transparent dot. In fact, everything is partially transparent to avoid excessive busyness in the plot. You could easily set this up to instead plot with the centre of the arrow being the location, or could tweak any of the other visual settings. In general, it is good to indicate where the vector originates for clarity. </p>
<p>Now we can finally plot the vectors. </p>
<pre><code>var i, j;  
for (i = xi/dx - 1; i &lt;= xf/dx + 1; i++) {
  for (j = yi/dy - 1; j &lt;= yf/dy + 1; j++) {
    createArrow(i*dx,j*dy);
  }
}
</code></pre>
<p>Note that the vectors are being plotted from just outside the desired area so that they can enter the plot from outside if needed. Now we have a vector plot! </p>
<p>The scaling factor <code>vecScaler</code> is the last thing to consider seriously. It is often important to distinguish between different vector lengths, but just setting <code>vecScaler = 1</code> will usually render the plot illegible with huge vectors shooting all over the place. There is no shortage of ways to scale, but one way the author has found helpful is to use a sigmoidal curve like <script type="math/tex">\tan^{-1}(x)</script>. Here is one option: </p>
<pre><code>var myScaler = function(vec,a,b) { return a*(Math.PI/2 - Math.atan(a/b*Math.sqrt(vec[0]**2 + vec[1]**2))) }
</code></pre>
<p>for some tuning constants a and b. Note that this function produces a multiplying factor, not the desired length directly. b is the maximum length of the vector relative to the grid size, which is often set to either 1 or 1.414 (the former being good for vectors that tend to point along gridlines and the latter being good for vectors that tend to point in the direction of the diagonals, or if you like a little bit of overlap). a is a measure of how fast the vector reaches the maximum length. You could tweak the values of a and b for each question, or you could pair up functions and scaling factors in the question variables when randomising. Regardless, it might be a good idea to copy-paste the graphing code into the question note so that you can check the scaling when deploying variants.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <center> Copyright &copy; 2023 Ricardo Largaespada </center>
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/rilarfer" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../../javascripts/removeCredits.js"></script>
      
    
  </body>
</html>