<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="http://rilarfer.stack-moodle.com/CAS/Numbers/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Numbers in STACK - STACK</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Numbers in STACK";
        var mkdocs_page_input_path = "CAS\\Numbers.md";
        var mkdocs_page_url = "/CAS/Numbers/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> STACK
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Buscar documentos" aria-label="Buscar documentos" title="Escriba el término de búsqueda aquí" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Menu de navegación">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Inicio</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../About/">About</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/">Guía Autoría inicio rápido</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/Authoring_quick_start_1/">1 Una pregunta básica</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/Authoring_quick_start_2/">2 Variables de la pregunta</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/Authoring_quick_start_3/">3 Mejorando la retroalimentación</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/Authoring_quick_start_4/">4 Aleatorización</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/Authoring_quick_start_5/">5 Test de Preguntas</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/Authoring_quick_start_6/">6 Preguntas matemáticas de varias partes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/Authoring_quick_start_7/">7 Desactivar la simplificación</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../AbInitio/Authoring_quick_start_8/">8 Importación y cuestionarios</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../Authoring/">Autoría</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../">CAS</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../Installation/">Instalación</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../Developer/">Desarrolladores</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../Moodle/">Moodle</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../Reference/">Referencias</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../Students/">Estudiantes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../Topics/">Temas</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Menú de navegación en móvil">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">STACK</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Documentos"></a></li>
      <li class="breadcrumb-item active">Numbers in STACK</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="numbers-in-stack">Numbers in STACK</h1>
<p>Separate pages document</p>
<ol>
<li><a href="../../Authoring/Answer_Tests/Numerical/">numerical answer tests</a>,</li>
<li><a href="../Complex_numbers/">complex numbers</a>.</li>
</ol>
<h2 id="precise-constants">Precise Constants</h2>
<p>In Maxima the special constants are defined to be</p>
<pre><code>%i, %e, %pi
</code></pre>
<p>etc.   STACK also uses single letters, e.g.</p>
<pre><code>e: %e
pi: %pi
</code></pre>
<p>Optionally, depending on the question settings, you have</p>
<pre><code>i: %i
j: %i
</code></pre>
<p>Sometimes you need to use <script type="math/tex">e</script>, or other constants, as an abstract symbol not a number.  The Maxima solution is to use the <code>kill()</code> command, but for security reasons users of STACK are not permitted to use this function. Instead use <code>stack_reset_vars(true)</code> in the question variables.  This resets all the special constants defined by STACK so the symbols can be redefined in an individual STACK question.  (On Maxima 5.42.1 (and possibly others) <code>stack_reset_vars(true)</code> also resets <code>ordergreat</code>, so if you need to use <code>stack_reset_vars(true)</code> it must be the first command the question variables.  Since this has been fixed in Maxima 5.44.0, it was probably a bug in Maxima.)</p>
<h2 id="modular-arithmetic">Modular arithmetic</h2>
<p>The function <code>recursemod(ex, n)</code> recurses over an expression tree, and applies the function <code>mod(?, n)</code> to any numbers as identified by <code>numberp</code>.  This works on any expression, whereas <code>polymod</code> only applies to polynomials.</p>
<h2 id="internal-representation-of-numbers">Internal representation of numbers</h2>
<p>Maxima has two data types to represent numbers: integers and floats.  Rational numbers are expressed as a division of two integers not with a dedicated data type, and surds with fractional powers or the <code>sqrt</code> function.
The option <a href="../../Authoring/Options/#surd">Surd for Square Root</a> enables the question author to alter the way surds are displayed in STACK.</p>
<p>Similarly, complex numbers are not represented as a single object, but as a sum of real and imaginary parts, or via the exponential function.
The input and display of complex numbers is difficult, since differences exist between mathematics, physics and engineering about which symbols to use.
The option <a href="../../Authoring/Options/#sqrt_minus_one">sqrt(-1)</a> is set in each question to sort out meaning and display.</p>
<h2 id="floating-point-numbers-floats">Floating point numbers ## {#Floats}</h2>
<ul>
<li>To convert to a float use Maxima's <code>float(ex)</code> command.</li>
<li>To convert a float to an exact representation use <code>rat(x)</code> to rationalise the decimal.</li>
</ul>
<p>The variable <script type="math/tex">e</script> has been defined as <code>e:exp(1)</code>.  This now potentially conflicts with scientific notation <code>2e3</code> which means <code>2*10^3</code>.    </p>
<p>If you expect students to use scientific notation for numbers, e.g. <code>3e4</code> (which means <script type="math/tex">3\times 10^{4}</script> ), then you may want to use the <a href="../../Authoring/Inputs/#Strict_Syntax">option for strict syntax</a>.  </p>
<p>Internally Maxima represents floats in binary, and so even simple calculations which would be exact in base ten (e.g. adding 0.16 to 0.12) might end up in a recurring decimal float which is not exactly equal to the result you would type in directly.  </p>
<p>Try <code>452-4.52*10^2</code> in desktop Maxima, which is not zero, therefore <code>ATAlgEquiv(452,4.52*10^2)</code> fails. (Maxima 5.44.0, November 2022).  <script type="math/tex">4.52\times 10^2</script> ends up with recurring 9s when represented as a binary float, so it is not algebraically equivalent to the integer <script type="math/tex">452</script>.</p>
<p>Rounding like this can also occur in calculations, for example</p>
<pre><code>p1:0.29;
p2:0.18;
p3:0.35;
v0:1-(p1+p2+p3);
v1:0.18;
</code></pre>
<p>Then Maxima returns <code>0.18</code> for <code>v0</code>, (as expected) but <code>v0-v1</code> equals <script type="math/tex">5.551115123125783*10^-17</script> and so <code>ATAlgEquiv(v0,v1)</code> will give false.  Please always use a <a href="../../Authoring/Answer_Tests/Numerical/">numerical test</a> when testing floats.</p>
<h2 id="maxima-and-floats-with-trailing-zeros">Maxima and floats with trailing zeros</h2>
<p>For its internal representation, Maxima always truncates trailing zeros from a floating point number.  For example, the Maxima expression <code>0.01000</code> will be converted internally to <code>0.01</code>.  Actually this is a byproduct of the process of converting a decimal input to an internal binary float, and back again.  Similarly, when a number is a "float" datatype, Maxima always prints at least one decimal digit to indicate the number is a float.  For example, the floating point representation of the number ten is <script type="math/tex">10.0</script>.  This does <em>not</em> indicate significant figures, rather it indicates data type.  In situations where the number of significant figures is crucial this is problematic.</p>
<p>Display of numbers in STACK is controlled with LaTeX, and the underlying LISP provides flexible ways to represent numbers.</p>
<p>Note, that apart from the units input, all other input types truncate the display of unnecessary trailing zeros in floating point numbers, loosing information about significant figures.  So, when the student's answer is a floating point number, trailing zeros will not be displayed.  If you want to specifically test for significant figures, use the <a href="../../Topics/Units/">units input type</a>, with the teacher's answer having no units.  The units input type should display the same number of significant figures as typed in by the student.  </p>
<h2 id="display-of-numbers-with-latex">Display of numbers with LaTeX</h2>
<p>The display of numbers is controlled by Maxima's <code>texnumformat</code> command, which STACK modifies.</p>
<p>Stack provides two variables to control the display of integers and floats respectively.  The default values are</p>
<pre><code>stackintfmt:"~d";
stackfltfmt:"~a";
</code></pre>
<p>These two variables control the output format of integers (identified by the predicate <code>integerp</code>) and floats (identified by the predicate <code>floatnump</code>) respectively.  These variables persist, so you need to define their values each time you expect them to change.</p>
<p>These variables must be assigned a string following Maxima's <code>printf</code> format.</p>
<p>These variables can be defined in the question variables, for global effect.  They can also be defined inside a Maxima block to control the display on the fly, and for individual expressions.  For example, consider the following CASText.</p>
<pre><code>The decimal number {@n:73@} is written in base \(2\) as {@(stackintfmt:"~2r",n)@}, in base \(7\) as {@(stackintfmt:"~7r",n)@}, in scientific notation as {@(stackintfmt:"~e",n)@} and in rhetoric as {@(stackintfmt:"~r",n)@}.
</code></pre>
<p>The result should be "The decimal number <script type="math/tex">73</script> is written in base <script type="math/tex">2</script> as <script type="math/tex">1001001</script>, in base <script type="math/tex">7</script> as <script type="math/tex">133</script>, in scientific notation as <script type="math/tex">7.3E+1</script> and in rhetoric as <script type="math/tex">seventy-three</script>."</p>
<p>To force all floating point numbers to scientific notation use</p>
<pre><code>stackfltfmt:"~e";
</code></pre>
<p>To force all floating point numbers to decimal floating point numbers use</p>
<pre><code>stackfltfmt:"~f";
</code></pre>
<p>You can also force all integers to be displayed as floating point decimals or in scientific notation using <code>stackintfmt</code> and the appropriate template.  This function calls the LISP <code>format</code> function, which is complex and more example are available <a href="http://www.gigamonkeys.com/book/a-few-format-recipes.html">online</a> elsewhere.</p>
<table>
<thead>
<tr>
<th>Template</th>
<th>Input</th>
<th>TeX Output</th>
<th>Description/notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>"~,4f"</code></td>
<td><code>0.12349</code></td>
<td>
<script type="math/tex">0.1235</script>
</td>
<td>Output four decimal places: floating point.</td>
</tr>
<tr>
<td></td>
<td><code>0.12345</code></td>
<td>
<script type="math/tex">0.1234</script>
</td>
<td>Note the rounding.</td>
</tr>
<tr>
<td></td>
<td><code>0.12</code></td>
<td>
<script type="math/tex">0.1200</script>
</td>
<td></td>
</tr>
<tr>
<td><code>"~,5e"</code></td>
<td><code>100.34</code></td>
<td>
<script type="math/tex">1.00340e+2</script>
</td>
<td>Output five decimal places: scientific notation.</td>
</tr>
<tr>
<td><code>"~:d"</code></td>
<td><code>10000000</code></td>
<td>
<script type="math/tex">10,000,000</script>
</td>
<td>Separate decimal groups of three digits with commas.</td>
</tr>
<tr>
<td><code>~r</code></td>
<td><code>9</code></td>
<td>
<script type="math/tex">\mbox{nine}</script>
</td>
<td>Rhetoric.</td>
</tr>
<tr>
<td><code>~:r</code></td>
<td><code>9</code></td>
<td>
<script type="math/tex">\mbox{ninth}</script>
</td>
<td>Ordinal rhetoric.</td>
</tr>
<tr>
<td><code>~7r</code></td>
<td><code>9</code></td>
<td>
<script type="math/tex">12</script>
</td>
<td>Base 7.</td>
</tr>
<tr>
<td><code>~@r</code></td>
<td><code>9</code></td>
<td>
<script type="math/tex">IX</script>
</td>
<td>Roman numerals.</td>
</tr>
<tr>
<td><code>~:@r</code></td>
<td><code>9</code></td>
<td>
<script type="math/tex">VIIII</script>
</td>
<td>Old style Roman numerals.</td>
</tr>
</tbody>
</table>
<p>There are many other options within the LISP format command. Please note with the rhetoric and Roman numerals that the numbers will be in LaTeX mathematics environments.</p>
<p>Note that the <code>@</code> symbol is currently not parsed correctly inside strings within CASText.  That is to say, you cannot currently type <code>{@(stackintfmt:"~@r",4)@}</code> into CASText.  This is a known bug.  To avoid this problem, define a variable in the question variables (e.g. <code>roman:"~@r";</code>) and use the variable name in the CASText (e.g. <code>{@(stackintfmt:roman,4)@}</code>).</p>
<p>Maxima has a separate system for controlling the number of decimal digits used in calculations and when printing the <em>value</em> of computed results.  Trailing zeros will not be printed with the value.  This is controlled by Maxima's <code>fpprec</code> and <code>fpprintprec</code> variables.  The default for STACK is</p>
<pre><code>fpprec:20,          /* Work with 20 digits. */
fpprintprec:12,     /* Print only 12 digits. */
</code></pre>
<h2 id="notes-about-numerical-rounding">Notes about numerical rounding</h2>
<p>There are two ways to round numbers ending in a digit <script type="math/tex">5</script>.  </p>
<ul>
<li>Always round up, so that <script type="math/tex">0.5\rightarrow 1</script>, <script type="math/tex">1.5 \rightarrow 2</script>, <script type="math/tex">2.5 \rightarrow 3</script> etc.</li>
<li>Another common system is to use ``Bankers' Rounding". Bankers Rounding is an algorithm for rounding quantities to integers, in which numbers which are equidistant from the two nearest integers are rounded to the nearest even integer. <script type="math/tex">0.5\rightarrow 0</script>, <script type="math/tex">1.5 \rightarrow 2</script>, <script type="math/tex">2.5 \rightarrow 2</script> etc.  The supposed advantage to bankers rounding is that in the limit it is unbiased, and so produces better results with some statistical processes that involve rounding.</li>
<li>In experimental work, the number of significant figures requires sometimes depends on the first digits of the number.  For example, if the first digit is a <script type="math/tex">1</script> or <script type="math/tex">2</script> then we need to take an extra significant figure to ensure the relative error is suitably small.  The maxima string functions can be used to check the first digit of a number until we have bespoke internal functions to make this check.</li>
</ul>
<p>Maxima's <code>round(ex)</code> command rounds multiples of 1/2 to the nearest even integer, i.e. Maxima implements Bankers' Rounding.  We do not currently have an option to always round up.</p>
<p>STACK has defined the function <code>significantfigures(x,n)</code> to conform to convention of rounding up.</p>
<h2 id="stack-numerical-functions-and-predicates">STACK numerical functions and predicates</h2>
<p>The following commands which are relevant to manipulation of numbers are defined by STACK.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>significantfigures(x,n)</code></td>
<td>Truncate <script type="math/tex">x</script> to <script type="math/tex">n</script> significant figures (does perform rounding).</td>
</tr>
<tr>
<td><code>decimalplaces(x,n)</code></td>
<td>Truncate <script type="math/tex">x</script> to <script type="math/tex">n</script> decimal places  (does perform rounding).</td>
</tr>
<tr>
<td><code>commonfaclist(l)</code></td>
<td>Returns the highest common factors of a list of numbers.</td>
</tr>
<tr>
<td><code>list_expression_numbers(ex)</code></td>
<td>Create a list with all parts for which <code>numberp(ex)=true</code>.</td>
</tr>
<tr>
<td><code>coeff_list(ex,v)</code></td>
<td>This function takes an expression <script type="math/tex">ex</script> and returns a list of coefficients of <script type="math/tex">v</script>.</td>
</tr>
<tr>
<td><code>coeff_list_nz(ex,v)</code></td>
<td>This function takes an expression <script type="math/tex">ex</script> and returns a list of nonzero coefficients of <script type="math/tex">v</script>.</td>
</tr>
<tr>
<td><code>numabsolutep(sa,ta,tol)</code></td>
<td>Is <script type="math/tex">sa</script> within <script type="math/tex">tol</script> of <script type="math/tex">ta</script>? I.e. (</td>
</tr>
<tr>
<td><code>numrelativep(sa,ta,tol)</code></td>
<td>Is <script type="math/tex">sa</script> within <script type="math/tex">tol\times ta</script> of <script type="math/tex">ta</script>? I.e. (</td>
</tr>
</tbody>
</table>
<p>The following commands generate displayed forms of numbers.  These will not be manipulated further automatically, so you will need to use these at the last moment, e.g. only when generating the teacher's answer etc.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dispdp(x,n)</code></td>
<td>Truncate <script type="math/tex">x</script> to <script type="math/tex">n</script> decimal places and display with trailing digits.  Note, this always prints as a float (or integer), and not in scientific notation.</td>
</tr>
<tr>
<td><code>dispsf(x,n)</code></td>
<td>Truncate <script type="math/tex">x</script> to <script type="math/tex">n</script> significant figures and display with trailing digits.  Note, this always prints as a float, and not in scientific notation.</td>
</tr>
<tr>
<td><code>scientific_notation(x,n)</code></td>
<td>Write <script type="math/tex">x</script> in the form <script type="math/tex">m10^e</script>.   Only works reliably with <code>simp:false</code> (e.g. try 9000).  The optional second argument applies <code>displaysci(m,n)</code> to the mantissa to control the display of trailing zeros.</td>
</tr>
<tr>
<td><code>displaydp(x,n)</code></td>
<td>An inert internal function to record that <script type="math/tex">x</script> should be displayed to <script type="math/tex">n</script> decimal places with trailing digits.  This function does no rounding.</td>
</tr>
<tr>
<td><code>displaysci(x,n,expo)</code></td>
<td>An inert internal function to record that <script type="math/tex">x</script> should be displayed to <script type="math/tex">n</script> decimal places with trailing digits, in scientific notation.  E.g. <script type="math/tex">x\times 10^{expo}</script>.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Function</th>
<th>Predicate</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>simp_numberp(ex)</code></td>
<td>Fixes <code>numberp(ex)</code> for <code>simp:false</code>.</td>
</tr>
<tr>
<td><code>real_numberp(ex)</code></td>
<td>Determines if <script type="math/tex">ex</script> is a real number.  This includes surds and symbolic numbers such as <script type="math/tex">\pi</script>.</td>
</tr>
<tr>
<td><code>lowesttermsp(ex)</code></td>
<td>Is the rational expression in its lowest terms?</td>
</tr>
<tr>
<td><code>anyfloatex(ex)</code></td>
<td>Decides if any floats are in the expression.</td>
</tr>
<tr>
<td><code>scientific_notationp(ex)</code></td>
<td>Determines if <script type="math/tex">ex</script> is written in the form <script type="math/tex">a10^n</script> where <script type="math/tex">a</script> is an integer or float, and <script type="math/tex">n</script> is an integer.</td>
</tr>
</tbody>
</table>
<h2 id="see-also">See also</h2>
<p><a href="../#reference">Maxima reference topics</a></p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright &copy; 2023 Ricardo Largaespada</p>
  </div>

  Construído con <a href="https://www.mkdocs.org/">MkDocs</a> usando <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provisto por <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versiones">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../../javascripts/removeCredits.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
